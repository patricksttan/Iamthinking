Using Theano backend.
Using gpu device 0: Tesla K40m (CNMeM is disabled, CuDNN 4007)
/hpc/sw/python-2.7.11/lib/python2.7/site-packages/theano/tensor/signal/downsample.py:6: UserWarning: downsample module has been moved to the theano.tensor.signal.pool module.
  "downsample module has been moved to the theano.tensor.signal.pool module.")
Read drivers data
Read train images
Load folder c0
Load folder c1
Load folder c2
Load folder c3
Load folder c4
Load folder c5
Load folder c6
Load folder c7
Load folder c8
Load folder c9
Unique drivers: 26
['p002', 'p012', 'p014', 'p015', 'p016', 'p021', 'p022', 'p024', 'p026', 'p035', 'p039', 'p041', 'p042', 'p045', 'p047', 'p049', 'p050', 'p051', 'p052', 'p056', 'p061', 'p064', 'p066', 'p072', 'p075', 'p081']
Directory doesnt exists
('Train shape:', (1462, 3, 224, 224))
(1462, 'train samples')
Read test images
Read 4 images from 47
Read 8 images from 47
Read 12 images from 47
Read 16 images from 47
Read 20 images from 47
Read 24 images from 47
Read 28 images from 47
Read 32 images from 47
Read 36 images from 47
Read 40 images from 47
Read 44 images from 47
Directory doesnt exists
('Test shape:', (47, 3, 224, 224))
(47, 'test samples')
Start Single Run
('Split train: ', 1403, 1403)
('Split valid: ', 59, 59)
('Train drivers: ', ['p002', 'p012', 'p014', 'p015', 'p016', 'p021', 'p022', 'p024', 'p026', 'p035', 'p039', 'p041', 'p042', 'p045', 'p047', 'p049', 'p050', 'p051', 'p052', 'p056', 'p061', 'p064', 'p066', 'p072', 'p075'])
('Test drivers: ', ['p081'])
--------------------------------------------------------------------------------
Initial input shape: (None, 3, 224, 224)
--------------------------------------------------------------------------------
Layer (name)                  Output Shape                  Param #             
--------------------------------------------------------------------------------
ZeroPadding2D (zeropadding2d) (None, 3, 226, 226)           0                   
Convolution2D (convolution2d) (None, 64, 224, 224)          1792                
ZeroPadding2D (zeropadding2d) (None, 64, 226, 226)          0                   
Convolution2D (convolution2d) (None, 64, 224, 224)          36928               
MaxPooling2D (maxpooling2d)   (None, 64, 112, 112)          0                   
ZeroPadding2D (zeropadding2d) (None, 64, 114, 114)          0                   
Convolution2D (convolution2d) (None, 128, 112, 112)         73856               
ZeroPadding2D (zeropadding2d) (None, 128, 114, 114)         0                   
Convolution2D (convolution2d) (None, 128, 112, 112)         147584              
MaxPooling2D (maxpooling2d)   (None, 128, 56, 56)           0                   
ZeroPadding2D (zeropadding2d) (None, 128, 58, 58)           0                   
Convolution2D (convolution2d) (None, 256, 56, 56)           295168              
ZeroPadding2D (zeropadding2d) (None, 256, 58, 58)           0                   
Convolution2D (convolution2d) (None, 256, 56, 56)           590080              
ZeroPadding2D (zeropadding2d) (None, 256, 58, 58)           0                   
Convolution2D (convolution2d) (None, 256, 56, 56)           590080              
MaxPooling2D (maxpooling2d)   (None, 256, 28, 28)           0                   
ZeroPadding2D (zeropadding2d) (None, 256, 30, 30)           0                   
Convolution2D (convolution2d) (None, 512, 28, 28)           1180160             
ZeroPadding2D (zeropadding2d) (None, 512, 30, 30)           0                   
Convolution2D (convolution2d) (None, 512, 28, 28)           2359808             
ZeroPadding2D (zeropadding2d) (None, 512, 30, 30)           0                   
Convolution2D (convolution2d) (None, 512, 28, 28)           2359808             
MaxPooling2D (maxpooling2d)   (None, 512, 14, 14)           0                   
ZeroPadding2D (zeropadding2d) (None, 512, 16, 16)           0                   
Convolution2D (convolution2d) (None, 512, 14, 14)           2359808             
ZeroPadding2D (zeropadding2d) (None, 512, 16, 16)           0                   
Convolution2D (convolution2d) (None, 512, 14, 14)           2359808             
ZeroPadding2D (zeropadding2d) (None, 512, 16, 16)           0                   
Convolution2D (convolution2d) (None, 512, 14, 14)           2359808             
MaxPooling2D (maxpooling2d)   (None, 512, 7, 7)             0                   
--------------------------------------------------------------------------------
Total params: 14714688
--------------------------------------------------------------------------------
Train on 1122 samples, validate on 281 samples
Epoch 1/10
  64/1122 [>.............................] - ETA: 85s - loss: 2.8182 - acc: 0.1719 128/1122 [==>...........................] - ETA: 79s - loss: 2.7568 - acc: 0.1562 192/1122 [====>.........................] - ETA: 74s - loss: 3.0442 - acc: 0.1406 256/1122 [=====>........................] - ETA: 69s - loss: 3.2034 - acc: 0.1289 320/1122 [=======>......................] - ETA: 64s - loss: 3.3574 - acc: 0.1313 384/1122 [=========>....................] - ETA: 59s - loss: 3.2908 - acc: 0.1302 448/1122 [==========>...................] - ETA: 54s - loss: 3.1603 - acc: 0.1295 512/1122 [============>.................] - ETA: 49s - loss: 3.0472 - acc: 0.1309 576/1122 [==============>...............] - ETA: 43s - loss: 2.9576 - acc: 0.1319 640/1122 [================>.............] - ETA: 38s - loss: 2.8883 - acc: 0.1250 704/1122 [=================>............] - ETA: 33s - loss: 2.8422 - acc: 0.1222 768/1122 [===================>..........] - ETA: 28s - loss: 2.8034 - acc: 0.1198 832/1122 [=====================>........] - ETA: 23s - loss: 2.7604 - acc: 0.1166 896/1122 [======================>.......] - ETA: 18s - loss: 2.7210 - acc: 0.1127 960/1122 [========================>.....] - ETA: 13s - loss: 2.6895 - acc: 0.11351024/1122 [==========================>...] - ETA: 7s - loss: 2.6555 - acc: 0.1152 1088/1122 [============================>.] - ETA: 2s - loss: 2.6327 - acc: 0.11671122/1122 [==============================] - 96s - loss: 2.6158 - acc: 0.1185 - val_loss: 4.8025 - val_acc: 0.0000e+00
Epoch 2/10
  64/1122 [>.............................] - ETA: 85s - loss: 2.2072 - acc: 0.0938 128/1122 [==>...........................] - ETA: 80s - loss: 2.1840 - acc: 0.1094 192/1122 [====>.........................] - ETA: 74s - loss: 2.1387 - acc: 0.1406 256/1122 [=====>........................] - ETA: 69s - loss: 2.1453 - acc: 0.1484 320/1122 [=======>......................] - ETA: 64s - loss: 2.1420 - acc: 0.1500 384/1122 [=========>....................] - ETA: 59s - loss: 2.1483 - acc: 0.1536 448/1122 [==========>...................] - ETA: 54s - loss: 2.1462 - acc: 0.1496 512/1122 [============>.................] - ETA: 49s - loss: 2.1450 - acc: 0.1504 576/1122 [==============>...............] - ETA: 44s - loss: 2.1529 - acc: 0.1458 640/1122 [================>.............] - ETA: 38s - loss: 2.1566 - acc: 0.1437 704/1122 [=================>............] - ETA: 33s - loss: 2.1606 - acc: 0.1392 768/1122 [===================>..........] - ETA: 28s - loss: 2.1664 - acc: 0.1354 832/1122 [=====================>........] - ETA: 23s - loss: 2.1649 - acc: 0.1382 896/1122 [======================>.......] - ETA: 18s - loss: 2.1603 - acc: 0.1406 960/1122 [========================>.....] - ETA: 13s - loss: 2.1591 - acc: 0.13961024/1122 [==========================>...] - ETA: 7s - loss: 2.1601 - acc: 0.1377 1088/1122 [============================>.] - ETA: 2s - loss: 2.1639 - acc: 0.13421122/1122 [==============================] - 97s - loss: 2.1637 - acc: 0.1328 - val_loss: 4.8891 - val_acc: 0.0000e+00
Epoch 3/10
  64/1122 [>.............................] - ETA: 85s - loss: 2.1561 - acc: 0.1250 128/1122 [==>...........................] - ETA: 80s - loss: 2.1589 - acc: 0.1328 192/1122 [====>.........................] - ETA: 74s - loss: 2.1448 - acc: 0.1302 256/1122 [=====>........................] - ETA: 69s - loss: 2.1486 - acc: 0.1094 320/1122 [=======>......................] - ETA: 64s - loss: 2.1376 - acc: 0.1281 384/1122 [=========>....................] - ETA: 59s - loss: 2.1384 - acc: 0.1354 448/1122 [==========>...................] - ETA: 54s - loss: 2.1384 - acc: 0.1451 512/1122 [============>.................] - ETA: 49s - loss: 2.1282 - acc: 0.1465 576/1122 [==============>...............] - ETA: 44s - loss: 2.1332 - acc: 0.1424 640/1122 [================>.............] - ETA: 38s - loss: 2.1316 - acc: 0.1406 704/1122 [=================>............] - ETA: 33s - loss: 2.1400 - acc: 0.1392 768/1122 [===================>..........] - ETA: 28s - loss: 2.1522 - acc: 0.1380 832/1122 [=====================>........] - ETA: 23s - loss: 2.1492 - acc: 0.1406 896/1122 [======================>.......] - ETA: 18s - loss: 2.1531 - acc: 0.1417 960/1122 [========================>.....] - ETA: 13s - loss: 2.1486 - acc: 0.14171024/1122 [==========================>...] - ETA: 7s - loss: 2.1459 - acc: 0.1455 1088/1122 [============================>.] - ETA: 2s - loss: 2.1506 - acc: 0.14431122/1122 [==============================] - 97s - loss: 2.1472 - acc: 0.1444 - val_loss: 4.1212 - val_acc: 0.0996
Epoch 4/10
  64/1122 [>.............................] - ETA: 85s - loss: 2.1330 - acc: 0.1094 128/1122 [==>...........................] - ETA: 80s - loss: 2.1464 - acc: 0.1406 192/1122 [====>.........................] - ETA: 74s - loss: 2.1138 - acc: 0.1823 256/1122 [=====>........................] - ETA: 69s - loss: 2.1150 - acc: 0.1719 320/1122 [=======>......................] - ETA: 64s - loss: 2.1319 - acc: 0.1656 384/1122 [=========>....................] - ETA: 59s - loss: 2.1334 - acc: 0.1562 448/1122 [==========>...................] - ETA: 54s - loss: 2.1329 - acc: 0.1518 512/1122 [============>.................] - ETA: 49s - loss: 2.1361 - acc: 0.1523 576/1122 [==============>...............] - ETA: 44s - loss: 2.1392 - acc: 0.1493 640/1122 [================>.............] - ETA: 38s - loss: 2.1317 - acc: 0.1531 704/1122 [=================>............] - ETA: 33s - loss: 2.1268 - acc: 0.1591 768/1122 [===================>..........] - ETA: 28s - loss: 2.1250 - acc: 0.1576 832/1122 [=====================>........] - ETA: 23s - loss: 2.1247 - acc: 0.1526 896/1122 [======================>.......] - ETA: 18s - loss: 2.1211 - acc: 0.1540 960/1122 [========================>.....] - ETA: 13s - loss: 2.1214 - acc: 0.15421024/1122 [==========================>...] - ETA: 7s - loss: 2.1255 - acc: 0.1484 1088/1122 [============================>.] - ETA: 2s - loss: 2.1255 - acc: 0.14711122/1122 [==============================] - 97s - loss: 2.1250 - acc: 0.1471 - val_loss: 4.9180 - val_acc: 0.0000e+00
Epoch 5/10
  64/1122 [>.............................] - ETA: 85s - loss: 2.1415 - acc: 0.0625 128/1122 [==>...........................] - ETA: 80s - loss: 2.0974 - acc: 0.1016 192/1122 [====>.........................] - ETA: 74s - loss: 2.1093 - acc: 0.0885 256/1122 [=====>........................] - ETA: 69s - loss: 2.1195 - acc: 0.0898 320/1122 [=======>......................] - ETA: 64s - loss: 2.1198 - acc: 0.1000 384/1122 [=========>....................] - ETA: 59s - loss: 2.1117 - acc: 0.1094 448/1122 [==========>...................] - ETA: 54s - loss: 2.1058 - acc: 0.1183 512/1122 [============>.................] - ETA: 49s - loss: 2.1040 - acc: 0.1211 576/1122 [==============>...............] - ETA: 44s - loss: 2.1032 - acc: 0.1233 640/1122 [================>.............] - ETA: 38s - loss: 2.1036 - acc: 0.1266 704/1122 [=================>............] - ETA: 33s - loss: 2.1059 - acc: 0.1264 768/1122 [===================>..........] - ETA: 28s - loss: 2.1095 - acc: 0.1302 832/1122 [=====================>........] - ETA: 23s - loss: 2.1082 - acc: 0.1310 896/1122 [======================>.......] - ETA: 18s - loss: 2.1085 - acc: 0.1306 960/1122 [========================>.....] - ETA: 13s - loss: 2.1087 - acc: 0.13021024/1122 [==========================>...] - ETA: 7s - loss: 2.1075 - acc: 0.1348 1088/1122 [============================>.] - ETA: 2s - loss: 2.1090 - acc: 0.13421122/1122 [==============================] - 97s - loss: 2.1109 - acc: 0.1373 - val_loss: 5.3243 - val_acc: 0.0000e+00
Epoch 6/10
  64/1122 [>.............................] - ETA: 85s - loss: 2.0751 - acc: 0.1406 128/1122 [==>...........................] - ETA: 80s - loss: 2.1193 - acc: 0.1094 192/1122 [====>.........................] - ETA: 75s - loss: 2.0911 - acc: 0.1406 256/1122 [=====>........................] - ETA: 69s - loss: 2.0984 - acc: 0.1484 320/1122 [=======>......................] - ETA: 64s - loss: 2.1104 - acc: 0.1406 384/1122 [=========>....................] - ETA: 59s - loss: 2.1134 - acc: 0.1458 448/1122 [==========>...................] - ETA: 54s - loss: 2.1026 - acc: 0.1607 512/1122 [============>.................] - ETA: 49s - loss: 2.1064 - acc: 0.1504 576/1122 [==============>...............] - ETA: 44s - loss: 2.1059 - acc: 0.1493 640/1122 [================>.............] - ETA: 38s - loss: 2.1058 - acc: 0.1500 704/1122 [=================>............] - ETA: 33s - loss: 2.1039 - acc: 0.1463 768/1122 [===================>..........] - ETA: 28s - loss: 2.1037 - acc: 0.1471 832/1122 [=====================>........] - ETA: 23s - loss: 2.1043 - acc: 0.1454 896/1122 [======================>.......] - ETA: 18s - loss: 2.1070 - acc: 0.1473 960/1122 [========================>.....] - ETA: 13s - loss: 2.1084 - acc: 0.14581024/1122 [==========================>...] - ETA: 7s - loss: 2.1108 - acc: 0.1465 1088/1122 [============================>.] - ETA: 2s - loss: 2.1135 - acc: 0.14711122/1122 [==============================] - 97s - loss: 2.1118 - acc: 0.1497 - val_loss: 5.4348 - val_acc: 0.0000e+00
Epoch 7/10
  64/1122 [>.............................] - ETA: 85s - loss: 2.0394 - acc: 0.1562 128/1122 [==>...........................] - ETA: 80s - loss: 2.0694 - acc: 0.1562 192/1122 [====>.........................] - ETA: 74s - loss: 2.0794 - acc: 0.1562 256/1122 [=====>........................] - ETA: 69s - loss: 2.1015 - acc: 0.1367 320/1122 [=======>......................] - ETA: 64s - loss: 2.0973 - acc: 0.1313 384/1122 [=========>....................] - ETA: 59s - loss: 2.0947 - acc: 0.1380 448/1122 [==========>...................] - ETA: 54s - loss: 2.1027 - acc: 0.1362 512/1122 [============>.................] - ETA: 49s - loss: 2.1080 - acc: 0.1367 576/1122 [==============>...............] - ETA: 44s - loss: 2.1054 - acc: 0.1406 640/1122 [================>.............] - ETA: 38s - loss: 2.1052 - acc: 0.1328 704/1122 [=================>............] - ETA: 33s - loss: 2.1095 - acc: 0.1236 768/1122 [===================>..........] - ETA: 28s - loss: 2.1115 - acc: 0.1250 832/1122 [=====================>........] - ETA: 23s - loss: 2.1101 - acc: 0.1298 896/1122 [======================>.......] - ETA: 18s - loss: 2.1088 - acc: 0.1317 960/1122 [========================>.....] - ETA: 13s - loss: 2.1082 - acc: 0.12811024/1122 [==========================>...] - ETA: 7s - loss: 2.1098 - acc: 0.1260 1088/1122 [============================>.] - ETA: 2s - loss: 2.1108 - acc: 0.12501122/1122 [==============================] - 97s - loss: 2.1100 - acc: 0.1275 - val_loss: 5.1307 - val_acc: 0.0000e+00
Epoch 8/10
  64/1122 [>.............................] - ETA: 85s - loss: 2.0642 - acc: 0.1406 128/1122 [==>...........................] - ETA: 80s - loss: 2.0917 - acc: 0.1328 192/1122 [====>.........................] - ETA: 74s - loss: 2.1186 - acc: 0.1094 256/1122 [=====>........................] - ETA: 69s - loss: 2.1073 - acc: 0.1328 320/1122 [=======>......................] - ETA: 64s - loss: 2.1112 - acc: 0.1375 384/1122 [=========>....................] - ETA: 59s - loss: 2.1076 - acc: 0.1484 448/1122 [==========>...................] - ETA: 54s - loss: 2.1051 - acc: 0.1518 512/1122 [============>.................] - ETA: 49s - loss: 2.1092 - acc: 0.1504 576/1122 [==============>...............] - ETA: 44s - loss: 2.1103 - acc: 0.1406 640/1122 [================>.............] - ETA: 38s - loss: 2.1142 - acc: 0.1422 704/1122 [=================>............] - ETA: 33s - loss: 2.1175 - acc: 0.1392 768/1122 [===================>..........] - ETA: 28s - loss: 2.1132 - acc: 0.1432 832/1122 [=====================>........] - ETA: 23s - loss: 2.1146 - acc: 0.1382 896/1122 [======================>.......] - ETA: 18s - loss: 2.1141 - acc: 0.1384 960/1122 [========================>.....] - ETA: 13s - loss: 2.1100 - acc: 0.14061024/1122 [==========================>...] - ETA: 7s - loss: 2.1133 - acc: 0.1426 1088/1122 [============================>.] - ETA: 2s - loss: 2.1153 - acc: 0.14151122/1122 [==============================] - 97s - loss: 2.1170 - acc: 0.1399 - val_loss: 5.1679 - val_acc: 0.0996
Epoch 9/10
  64/1122 [>.............................] - ETA: 85s - loss: 2.0659 - acc: 0.1875 128/1122 [==>...........................] - ETA: 80s - loss: 2.1063 - acc: 0.1641 192/1122 [====>.........................] - ETA: 75s - loss: 2.1167 - acc: 0.1510 256/1122 [=====>........................] - ETA: 69s - loss: 2.1181 - acc: 0.1406 320/1122 [=======>......................] - ETA: 64s - loss: 2.1166 - acc: 0.1406 384/1122 [=========>....................] - ETA: 59s - loss: 2.1175 - acc: 0.1380 448/1122 [==========>...................] - ETA: 54s - loss: 2.1216 - acc: 0.1339 512/1122 [============>.................] - ETA: 49s - loss: 2.1136 - acc: 0.1387 576/1122 [==============>...............] - ETA: 44s - loss: 2.1088 - acc: 0.1441 640/1122 [================>.............] - ETA: 38s - loss: 2.1079 - acc: 0.1469 704/1122 [=================>............] - ETA: 33s - loss: 2.1124 - acc: 0.1449 768/1122 [===================>..........] - ETA: 28s - loss: 2.1122 - acc: 0.1471 832/1122 [=====================>........] - ETA: 23s - loss: 2.1128 - acc: 0.1454 896/1122 [======================>.......] - ETA: 18s - loss: 2.1146 - acc: 0.1406 960/1122 [========================>.....] - ETA: 13s - loss: 2.1165 - acc: 0.14171024/1122 [==========================>...] - ETA: 7s - loss: 2.1137 - acc: 0.1416 1088/1122 [============================>.] - ETA: 2s - loss: 2.1123 - acc: 0.14251122/1122 [==============================] - 97s - loss: 2.1130 - acc: 0.1408 - val_loss: 5.2055 - val_acc: 0.0000e+00
Epoch 10/10
  64/1122 [>.............................] - ETA: 85s - loss: 2.1715 - acc: 0.0781 128/1122 [==>...........................] - ETA: 80s - loss: 2.1440 - acc: 0.1250 192/1122 [====>.........................] - ETA: 75s - loss: 2.1391 - acc: 0.1354 256/1122 [=====>........................] - ETA: 69s - loss: 2.1260 - acc: 0.1445 320/1122 [=======>......................] - ETA: 64s - loss: 2.1238 - acc: 0.1344 384/1122 [=========>....................] - ETA: 59s - loss: 2.1251 - acc: 0.1380 448/1122 [==========>...................] - ETA: 54s - loss: 2.1175 - acc: 0.1362 512/1122 [============>.................] - ETA: 49s - loss: 2.1167 - acc: 0.1406 576/1122 [==============>...............] - ETA: 44s - loss: 2.1096 - acc: 0.1424 640/1122 [================>.............] - ETA: 38s - loss: 2.1056 - acc: 0.1500 704/1122 [=================>............] - ETA: 33s - loss: 2.1093 - acc: 0.1477 768/1122 [===================>..........] - ETA: 28s - loss: 2.1089 - acc: 0.1445 832/1122 [=====================>........] - ETA: 23s - loss: 2.1037 - acc: 0.1478 896/1122 [======================>.......] - ETA: 18s - loss: 2.1074 - acc: 0.1451 960/1122 [========================>.....] - ETA: 13s - loss: 2.1105 - acc: 0.14691024/1122 [==========================>...] - ETA: 7s - loss: 2.1116 - acc: 0.1426 1088/1122 [============================>.] - ETA: 2s - loss: 2.1099 - acc: 0.14061122/1122 [==============================] - 97s - loss: 2.1110 - acc: 0.1399 - val_loss: 5.5495 - val_acc: 0.0000e+00
59/59 [==============================] - 1s
('Score log_loss: ', 2.6034537403395572)
47/47 [==============================] - 1s
Final log_loss: 2.60345374034, rows: 224 cols: 224 epoch: 10
